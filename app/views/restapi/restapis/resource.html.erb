<ul class='breadcrumb'>
  <li><a href='<%= @doc[:doc_url] %>'><%= @doc[:name] %></a><span class='divider'>/</span></li>
  <li class='active'><%= @resource[:name] %></li>
</ul>

<div class='page-header'>
  <h1>
    <%= @resource[:name] %><br>
    <small><%= raw @resource[:short_description] %></small>
  </h1>
</div>


<% unless @resource[:full_description].blank? %>
  <div><%= raw @resource[:full_description] %></div>
<% end %>

<div class='accordion' id='accordion'>
  
  <% @resource[:methods].each do |m| %>
    <hr>
    <div class='pull-right small'>
      <a href='<%= m[:doc_url] %>'> >>> </a>
    </div>
    <div>
      <% m[:apis].each do |api| %>
        <h3>
          <a href='#description-<%= m[:name] %>'
           class='accordion-toggle'
           data-toggle='collapse'
           data-parent='#accordion'>
            <%= api[:http_method] %> <%= api[:api_url] %>
          </a><br>
          <small><%= raw api[:short_description] %></small>
        </h3>
      <% end %>
    </div>
    
    <div id='description-<%= m[:name] %>' class='collapse accordion-body'>
      
      <%= raw m[:full_description] %>
      <% unless m[:errors].blank? %>
        <h2>Errors</h2>
        <% m[:errors].each do |err| %>
          <%= err.code %>
          <%= err.description %>
          <br>
        <% end %>
      <% end %>
        
      <% unless m[:params].blank? %>
        <h2>Params</h2>
        <table class='table'>
          <thead>
            <tr>
              <th>Param name</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <% m[:params].each do |val| %>
              <tr>
                <td>
                  <strong><%= val[:name] %></strong><br>
                  <small>
                    <%= val[:required] ? 'required' : 'optional' %>
                    <%= val[:allow_nil] ? ', nil allowed' : '' %>
                  </small>
                </td>
                <td>
                  <%= raw val[:description] %><br>
                  
                  <% unless val[:validator].blank? %>
                    Value: <%= val[:validator] %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>
    </div>
  <% end %>
</div>

<% content_for :restapi_footer do %>
  <%= raw @doc[:copyright] %>
<% end %>